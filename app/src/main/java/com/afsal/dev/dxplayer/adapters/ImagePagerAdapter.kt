package com.afsal.dev.dxplayer.adaptersimport android.view.LayoutInflaterimport android.view.Viewimport android.view.ViewGroupimport androidx.recyclerview.widget.AsyncListDifferimport androidx.recyclerview.widget.DiffUtilimport androidx.recyclerview.widget.RecyclerViewimport com.afsal.dev.dxplayer.databinding.PagerItemBindingimport com.afsal.dev.dxplayer.models.photosSections.ImageModelimport com.afsal.dev.dxplayer.utills.CoreUttilesclass ImagePagerAdapter(private val prev:Int,private var onItemChanged: ((photo:ImageModel) ->Unit)):RecyclerView.Adapter<ImagePagerAdapter.ImageViewHolder>() {   private var prevPosition=prev    private val diffCallback=object :DiffUtil.ItemCallback<ImageModel>(){        override fun areItemsTheSame(oldItem: ImageModel, newItem: ImageModel): Boolean {            return oldItem.id==newItem.id        }        override fun areContentsTheSame(oldItem: ImageModel, newItem: ImageModel): Boolean {          return oldItem==newItem        }    }    val differ=AsyncListDiffer(this,diffCallback) inner   class ImageViewHolder(val binding: PagerItemBinding):RecyclerView.ViewHolder(binding.root){                 fun bind(){                     val photo:ImageModel                     var abselutPosition=prev                val positionAbs=absoluteAdapterPosition                     if (positionAbs   != RecyclerView.NO_POSITION){                         photo=differ.currentList[positionAbs]                         if (positionAbs > prevPosition){                             abselutPosition  = positionAbs-1                         }else if ( positionAbs < prevPosition){                             abselutPosition =positionAbs+1                         }else if ( positionAbs== differ.currentList.size){                             abselutPosition  =positionAbs                         }                         prevPosition=abselutPosition                         onItemChanged(differ.currentList[abselutPosition])                         binding.apply {                             CoreUttiles.loadImageIntoView(photo.contentUri,null, binding.pagerImage, CoreUttiles.CUSTOM_IMAGE_VIEW)                            // pagerImage.onDrawableLoaded ={binding.progress.visibility= View.GONE }                           //  pagerImage.disallowPagingWhenZoomed                            // pagerImage.swipeToDismissEnabled = true                         }                     }                    //pagerImage.apply { //  debugInfoVisible = true swipeToDismissEnabled = true                 }    }    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ImageViewHolder {        return ImageViewHolder(PagerItemBinding.inflate(LayoutInflater.from(parent.context),parent,false))    }    override fun onBindViewHolder(holder: ImageViewHolder, position: Int) {                              holder.bind() }    override fun getItemCount()=differ.currentList.size}